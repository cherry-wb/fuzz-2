# The top-level Makefile that is used to build 

# State the platforms for which we are building
BUILD_FOR_LINUX=@BUILD_FOR_LINUX@
BUILD_FOR_WINDOWS=@BUILD_FOR_WINDOWS@

VERSION = @VERSION@

SUBDIRS := firefox

ifdef PRINT_DIRECTORIES
MAKE_CMD = $(MAKE) -j -l 5.0 
MAKE_DIR = $(MAKE_CMD) -C $(dir)
else
MAKE_CMD = $(MAKE) -j -l 5.0 --no-print-directory -s 
MAKE_DIR = $(MAKE_CMD) -C $(dir)
endif

ifeq ($(BUILD_FOR_LINUX),yes)
LINUX_LIBS_DIR = @FUZZBOTDIR@/libs/linux
endif

ifeq ($(BUILD_FOR_WINDOWS),yes)
WINDOWS_LIBS_DIR = @FUZZBOTDIR@/libs/windows
endif

.PHONY: all verbose clean test docs

all: docs
	@$(foreach dir,$(SUBDIRS),$(MAKE_DIR) build-objects build-libraries &&) true
	@$(foreach dir,$(SUBDIRS),$(MAKE_DIR) build-executables &&) true

clean:
	@$(foreach dir,$(SUBDIRS),MAKE_CLEAN_ACTIVE=true $(MAKE_DIR) clean &&) true
	@rm -rf libs/*
	@echo "Removed all objects and libraries."

tests: all
	@echo "No tests yet..."

docs:
	@$(MAKE_DIR) docs

packages: all
	@echo "Package building not implemented yet..."

install: 
	@echo "Install not implemented yet..."

verbose:
	PRINT_DIRECTORIES=true $(MAKE) all
